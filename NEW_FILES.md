# ุงููููุงุช ุงูุฌุฏูุฏุฉ ุงููุถุงูุฉ ูููุดุฑูุน

## Backend TypeScript Stack

### ๐ ูููุงุช ุงูุชูููู (config/)
- โ `constants.json` - ุงูุฅุนุฏุงุฏุงุช ุงูุนุงูุฉ (ุงูููุทูุฉ ุงูุฒูููุฉุ ูุชุฑุงุช ุงูุทูุงุจูุฑุ ุฅุนุฏุงุฏุงุช PIN)
- โ `clinics.json` - ุจูุงูุงุช ุงูุนูุงุฏุงุช (12 ุนูุงุฏุฉ ูุน ูุนูููุงุช ุงูุทูุงุจู)
- โ `routeMap.json` - ุฎุฑุงุฆุท ุงููุณุงุฑุงุช ุงูุทุจูุฉ ุจุงูุนุฑุจูุฉ (ุฏูุฑุงุชุ ุชุฌููุฏุ ุชุฑููุนุ ุฅูุฎ)

### ๐ ุงูุฎุงุฏู ุงูุฎููู (src/)

#### ููุทุฉ ุงูุฏุฎูู
- โ `src/index.ts` - Express server bootstrap ูุน ุฌููุน ุงูููุฌูุงุช ูุงูุฌุฏููุฉ

#### API Routes (src/api/routes/)
- โ `pin.ts` - ุฅุตุฏุงุฑ ูุงูุชุญูู ูู ุฃุฑูุงู PIN
- โ `queue.ts` - ุฏุฎูู ูุฅููุงู ุงูุทูุงุจูุฑ
- โ `route.ts` - ุชุนููู ุงููุณุงุฑุงุช ูุงูุงูุชูุงู ุจูู ุงูุนูุงุฏุงุช
- โ `events.ts` - Server-Sent Events ููุฅุดุนุงุฑุงุช ุงูุญูุฉ

#### ุงูุฎุฏูุงุช ุงูุฃุณุงุณูุฉ (src/core/)
- โ `pinService.ts` - ุฅุฏุงุฑุฉ ุฃุฑูุงู PIN ูุน ุชุฎุฒูู ูููู
- โ `queueManager.ts` - ุฅุฏุงุฑุฉ ุงูุทูุงุจูุฑ ูุงููุฏุงุก ุงูุขูู
- โ `routing/routeService.ts` - ุฅูุดุงุก ูุฅุฏุงุฑุฉ ุงููุณุงุฑุงุช ุงูุทุจูุฉ
- โ `notifications/notificationService.ts` - ูุธุงู ุงูุฅุดุนุงุฑุงุช SSE
- โ `validation/validateBeforeDisplay.ts` - ุงูุชุญูู ูู ุตุญุฉ ุงูุชุฐุงูุฑ
- โ `monitor/health-check.ts` - ูุญุต ุตุญุฉ ุงููุธุงู

#### ุงูุฃุฏูุงุช ุงููุณุงุนุฏุฉ (src/utils/)
- โ `fs-atomic.ts` - ุนูููุงุช ูุฑุงุกุฉ/ูุชุงุจุฉ ุขููุฉ ูููููุงุช
- โ `logger.ts` - ูุธุงู ุงูุณุฌูุงุช ูุงูุชุฏููู
- โ `time.ts` - ูุนุงูุฌุฉ ุงูุชูููุช ูุน ุงูููุทูุฉ ุงูุฒูููุฉ (Asia/Qatar)

#### ุงูุชุนุฑููุงุช (src/types/)
- โ `cors.d.ts` - ุชุนุฑููุงุช TypeScript ูู CORS

### ๐ ุงูุชูููู (ุฌุฐุฑ ุงููุดุฑูุน)
- โ `tsconfig.json` - ุฅุนุฏุงุฏุงุช TypeScript (NodeNext, ES2020)
- โ `.env.example` - ูุซุงู ุนูู ูุชุบูุฑุงุช ุงูุจูุฆุฉ

### ๐ ุงููุงุฌูุฉ ุงูุฃูุงููุฉ ุงููุญุฏุซุฉ
- โ `src/App.jsx` - ูุญุฏุซ ูุน ูุธุงู SSE ูุงูุฅุดุนุงุฑุงุช ุงูุตูุชูุฉ

## ๐ ุงูุชุญุฏูุซุงุช ุนูู package.json

### Scripts ุงูุฌุฏูุฏุฉ
```json
{
  "server:build": "tsc -p .",
  "server:dev": "node --loader ts-node/esm --no-warnings src/index.ts",
  "server:start": "node dist_server/index.js"
}
```

### Dependencies ุงูุฌุฏูุฏุฉ
```json
{
  "body-parser": "^1.20.2",
  "cookie-parser": "^1.4.6"
}
```

### DevDependencies ุงูุฌุฏูุฏุฉ
```json
{
  "ts-node": "^10.9.2"
}
```

## ๐ ูููู ุงูุจูุงูุงุช

### data/pins/
- ุชุฎุฒูู ูููู ูุฃุฑูุงู PIN ุงูููุตุฏุฑุฉ
- ูุซุงู: `data/pins/2025-10-15.json`

### data/queues/
- ุทูุงุจูุฑ ููุธูุฉ ุญุณุจ ุงูุนูุงุฏุฉ ูุงูุชุงุฑูุฎ
- ูุซุงู: `data/queues/LAB/2025-10-15.json`

### data/routes/
- ูุณุงุฑุงุช ุงููุฑุงุฌุนูู ุงููุฑุฏูุฉ
- ูุซุงู: `data/routes/V12345.json`

### data/audit/
- ุณุฌูุงุช ุงูุชุฏููู ุงูููููุฉ
- ูุซุงู: `data/audit/2025-10-15.log`

## ๐ฏ ุงูููุฒุงุช ุงููุถุงูุฉ

### 1. ูุธุงู PIN ุงููุญุณูู
- ุฅุตุฏุงุฑ ุชุณูุณูู ุขูู
- ูุทุงู ูุงุจู ููุชูููู ููู ุนูุงุฏุฉ
- ุชุฎุฒูู ูููู ูููุตู
- ุงูุชุญูู ูู ุงูุตูุงุญูุฉ

### 2. ุฅุฏุงุฑุฉ ุงูุทูุงุจูุฑ ุงูุฐููุฉ
- ุฌุฏููุฉ ุขููุฉ ูููุฏุงุก
- ุชุชุจุน ุญุงูุฉ ุงููุฑุงุฌุนูู (ููุชุธุฑ/ููุงุฏุงุฉ/ููุชูู)
- ุฅุญุตุงุฆูุงุช ุงูููุช ุงูุญูููู

### 3. ุงููุณุงุฑุงุช ุงูุทุจูุฉ ุงููุฑูุฉ
- ุฏุนู ูุณุงุฑุงุช ูุชุนุฏุฏุฉ (ุฏูุฑุงุชุ ุชุฌููุฏุ ุฅูุฎ)
- ุชุฎุตูุต ุญุณุจ ุงูุฌูุณ
- ุชุชุจุน ุงูุชูุฏู ุฎุทูุฉ ุจุฎุทูุฉ
- ูุชุญ ุงูุนูุงุฏุฉ ุงูุชุงููุฉ ุชููุงุฆูุงู

### 4. ุงูุฅุดุนุงุฑุงุช ุงูุญูุฉ
- SSE ูุชุญุฏูุซุงุช ููุฑูุฉ
- ุฅุดุนุงุฑุงุช ูุจู ุงูุฏูุฑ ุจู3 ุฃุดุฎุงุต
- ุฅุดุนุงุฑ ุนูุฏ ุญููู ุงูุฏูุฑ
- ุตูุช ุชูุจูู ููุฅุดุนุงุฑุงุช

### 5. ุงูุชุญูู ูู ุงูุตุญุฉ
- ูุญุต ุงูุชุฐูุฑุฉ ูุจู ุงูุนุฑุถ
- ูุดู ุงูุชุฃุฎูุฑุงุช (> 5 ุฏูุงุฆู)
- ุงูุชุญูู ูู ุงูุญุงูุฉ ุงููุดุทุฉ
- ููุน ุงูุชูุฑุงุฑุงุช

### 6. ุงููุฑุงูุจุฉ ูุงูุตุญุฉ
- ููุทุฉ `/api/health` ูููุญุต
- ุณุฌูุงุช ุชุฏููู ุชูุตูููุฉ
- ุชุชุจุน ุฌููุน ุงูุนูููุงุช
- ุชูุงุฑูุฑ ุงูุฃุฎุทุงุก

## ๐ง ููููุฉ ุงูุงุณุชุฎุฏุงู

### ุชุดุบูู ุงูุฎุงุฏู ุงูุฎููู
```bash
# Development mode with hot reload
npm run server:dev

# Build for production
npm run server:build

# Run production server
npm run server:start
```

### ุชุดุบูู ุงูุชุทููุฑ ุงููุงูู
```powershell
# ูู ูุงูุฐุฉ PowerShell ูุงุญุฏุฉ
npm run dev

# ูู ูุงูุฐุฉ ุฃุฎุฑู
npm run server:dev
```

### API Examples

#### ุฅุตุฏุงุฑ PIN
```bash
curl -X POST http://localhost:3000/api/pin/issue \
  -H "Content-Type: application/json" \
  -d '{"clinicId": "LAB"}'
```

#### ุฏุฎูู ุงูุทุงุจูุฑ
```bash
curl -X POST http://localhost:3000/api/queue/enter \
  -H "Content-Type: application/json" \
  -d '{"clinicId": "LAB", "visitId": "V12345"}'
```

#### ุชุนููู ูุณุงุฑ
```bash
curl -X POST http://localhost:3000/api/route/assign \
  -H "Content-Type: application/json" \
  -d '{"visitId": "V12345", "examType": "ุชุฌููุฏ", "gender": "M"}'
```

#### ุงูุงุณุชูุงุน ููุฅุดุนุงุฑุงุช
```javascript
const eventSource = new EventSource('/api/events');
eventSource.onmessage = (event) => {
  const data = JSON.parse(event.data);
  console.log('Notice:', data);
};
```

## ๐ ููุงุญุธุงุช ูููุฉ

1. **TypeScript Configuration**: ุงุณุชุฎุฏุงู NodeNext ูุฏุนู ESM ุงูุฃุตูู
2. **Import Extensions**: ูุฌุจ ุฅุถุงูุฉ `.js` ูู imports ุญุชู ููููุงุช `.ts`
3. **JSON Imports**: ุงุณุชุฎุฏุงู `with { type: 'json' }` ููุชูุงูู
4. **Atomic Writes**: ุฌููุน ุนูููุงุช ุงููุชุงุจุฉ ุชุณุชุฎุฏู ูููุงุช ูุคูุชุฉ ูุถูุงู ุงูุณูุงูุฉ
5. **Time Zones**: ุงูููุทูุฉ ุงูุฒูููุฉ ุงูุงูุชุฑุงุถูุฉ Asia/Qatar ูุน pivot ุงูุณุงุนุฉ 5 ุตุจุงุญุงู
6. **Audit Logs**: ุณุฌูุงุช ููููุฉ ูููุตูุฉ ูุณูููุฉ ุงููุฑุงุฌุนุฉ

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ

- [ ] ุฅุถุงูุฉ ุงุฎุชุจุงุฑุงุช ููุฎุฏูุงุช ุงูุฌุฏูุฏุฉ
- [ ] ุชูุซูู API ูุน Swagger
- [ ] ุฅุถุงูุฉ ูุตุงุฏูุฉ JWT
- [ ] ุชุญุณูู ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก
- [ ] ุฅุถุงูุฉ ูุงุนุฏุฉ ุจูุงูุงุช (PostgreSQL/Redis)
- [ ] ุฅุนุฏุงุฏ Docker container
- [ ] CI/CD pipeline

---

**ุชุงุฑูุฎ ุงูุฅูุดุงุก**: ุฃูุชูุจุฑ 2025  
**ุงูุฅุตุฏุงุฑ**: 1.0.0
