# مذكرة هيكلية المشروع بعد إعادة التنظيم

## مقدمة
تمت إعادة هيكلة المشروع إلى نمط monorepo بحيث تم الفصل الكامل بين الواجهة (frontend) والخادم (backend) مع تنظيم داخلي واضح لكل جزء. الهدف هو تسهيل التطوير، الاختبار، النشر، وضمان وضوح الاعتمادية بين المكونات.

---

## الهيكلية الجديدة

```
2026/
  apps/
    frontend/
      src/
        App.jsx
        main.jsx
        index.css
        components/
        lib/
        config/
        theme/
        utils/
        types/
        pages/
        offline/
        reports/
        security/
        core/
        infra/
      public/
      ...
    backend/
      src/
        index.ts
        api/
        core/
        middle/
        reports/
        security/
        types/
        utils/
        components/
        infra/
        offline/
        pages/
        theme/
        lib/
      config/
      ...
```

---

## شرح كل جزء

### apps/frontend
- **src/**: جميع ملفات React (App.jsx, main.jsx, index.css) والمكونات (components)، وأي مكتبات أو أدوات تخص الواجهة.
- **public/**: ملفات ثابتة (صور، manifest، favicon، إلخ).
- **lib/**: مكتبات مساعدة للواجهة (api.js، i18n.js، إلخ).
- **config/**: إعدادات تخص الواجهة فقط.
- **theme/**: ملفات الثيمات والألوان.
- **utils/**: أدوات مساعدة عامة للواجهة.
- **types/**: تعريفات TypeScript أو JSDoc للواجهة.
- **pages/**: صفحات React (إن وجدت).
- **offline/**: ملفات الـ Service Worker أو دعم العمل دون اتصال.
- **reports/**: تقارير أو صفحات عرض تقارير للواجهة.
- **security/**: مكونات أو أدوات تخص الأمان في الواجهة.
- **core/infra**: أي منطق أعمال أو بنية تحتية تخص الواجهة.

### apps/backend
- **src/**: جميع ملفات الخادم (index.ts نقطة الدخول)، وملفات Express، والراوترات، والمنطق الأساسي.
- **api/**: جميع نقاط النهاية (routes) الخاصة بـ Express.
- **core/**: منطق الأعمال (queueManager، pinService، routing، إلخ).
- **middle/**: طبقات وسطية (middleware) أو مدراء إعدادات.
- **reports/**: بناء التقارير وتوليدها (PDF، Excel، إلخ).
- **security/**: الحماية (guards، التوثيق، إلخ).
- **types/**: تعريفات TypeScript للخادم.
- **utils/**: أدوات مساعدة عامة للخادم.
- **components/**: مكونات قابلة لإعادة الاستخدام (إن وجدت).
- **infra/**: بنية تحتية (اتصال قاعدة بيانات، ملفات النظام، إلخ).
- **offline/**: دعم العمل دون اتصال أو ملفات SW خاصة بالخادم.
- **pages/**: صفحات HTML أو قوالب تُخدم من الخادم (إن وجدت).
- **theme/**: ثيمات تخص التقارير أو واجهات الإدارة.
- **lib/**: مكتبات مساعدة للخادم.
- **config/**: إعدادات الخادم (routeMap.json، إلخ).

---

## أسباب النقل والتحسينات
- **وضوح الفصل**: أصبح لكل من الواجهة والخادم مسار واضح ومستقل، مما يسهل التطوير المتوازي.
- **سهولة الاختبار**: يمكن اختبار كل جزء بمعزل عن الآخر.
- **إدارة الاعتمادية**: لم يعد هناك تداخل في الاستيرادات أو المسارات.
- **التحضير للنشر المستقل**: يمكن نشر كل جزء على حدة (مثلاً Vercel للواجهة وVPS للخادم).
- **سهولة التوسع**: إضافة خدمات أو واجهات جديدة (مثل mobile) يصبح أسهل.

---

## ملاحظات هامة
- تم تحديث جميع المسارات في الاستيرادات والتصديرات لتتوافق مع الهيكلية الجديدة.
- لم يتم حذف أي ملف إنتاجي، فقط نقل مع الحفاظ على جميع المسارات.
- جميع السكربتات وأدوات البناء والتدقيق تم تحديثها لتعمل مع الهيكلية الجديدة.
- يمكن العودة لأي ملف من النسخ الاحتياطية أو من git عند الحاجة.

---

## خطوات التحقق بعد النقل
1. تشغيل build للواجهة والخادم كلٌ على حدة.
2. تشغيل smokeTest على الخادم.
3. التأكد من عمل جميع المسارات الأساسية (API، صفحات React).

---

## الأسئلة الشائعة
- **هل يمكن دمج جزء من الواجهة مع الخادم؟** نعم، لكن الفصل أفضل للصيانة والتوسع.
- **هل يمكن إضافة تطبيقات أخرى؟** نعم، فقط أضف apps/mobile أو apps/admin حسب الحاجة.

---

تمت العملية بنجاح. لأي استفسار راجع هذه المذكرة أو تواصل مع فريق التطوير.
